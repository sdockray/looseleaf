<html>
<head>
<title>BOOKS WITHOUT COVERS</title>
<script src="js/spine.js"></script>
<style>
body {
  padding: 0;
  margin: 0;
  overflow-x: hidden;
}
.focus {
  position: absolute;
  z-index: 50;
  border: 1px solid red;
  width: 700px;
  height: 350px;
  overflow: auto;
  overflow-x: hidden;
}
.focus img {
  width: 700px;
}
.on {
  position: absolute;
  width: 50px;
  height: 72px;
  border: 1px dotted red;
}
</style>
</head>
<body>
<script>

var texts = [
    ["3124e4687f871666c5c37deae3df4161", 60],
    ["a989ec600e2a9938333e7481f8adaa25", 24],
    ["92b93ce08db7765cb6229260d6ad7c18", 84],
    ["eee69fd03eff97594cc6b0846b24986e", 40],
    ["f923e59edda2f3866222b665ffad4cb4", 3]].map(function(x) {
        return new Text(x[0], x[1]);
    });
var line = new Line(texts);
var flow = new Flow(line, document.body.clientWidth);
document.body.appendChild(flow.$el);

var focus = new Focus();
document.body.appendChild(focus.$el);

var $on = document.createElement("div");
$on.className = "on";
document.body.appendChild($on);

flow.onclick = function(p, pos) {
    focus.setPage(p);
    focus.$el.style.left = (flow.width - focus.$el.clientWidth) * (pos[0] / flow.width);
    focus.$el.style.top = pos[1] + thH;
    focus.$el.scrollTop = 0;

    $on.style.left = pos[0];
    $on.style.top = pos[1];
}

draw_visible(flow);

var scroll_queue=0;
window.onscroll = function() {
    scroll_queue += 1;
    window.setTimeout(function() {
        scroll_queue -= 1;
        if(scroll_queue === 0) {
            console.log("draw visible!");
            draw_visible(flow);
        }
        else {
        }
    }, 50);
};

</script>
</body>
</html>
